# ğŸ›¡ï¸ AegisSense

### Intelligent WAF/IDS Log Noise-Reduction & Security Alert Analysis Console

> **AegisSense** æ˜¯ä¸€ä¸ªèåˆæœºå™¨å­¦ä¹ ä¸è§„åˆ™å¼•æ“çš„æ™ºèƒ½å‘Šè­¦åˆ†ææ§åˆ¶å°ï¼Œ
> æ—¨åœ¨ä¸º WAF/IDS ç³»ç»Ÿæä¾›â€œä½è¯¯æŠ¥ã€å¯è§£é‡Šã€å¯æ ¡å‡†â€çš„å®‰å…¨æ—¥å¿—é™å™ªä¸å¯è§†åŒ–èƒ½åŠ›ã€‚

---

## ğŸŒ é¡¹ç›®æ¦‚è§ˆ

| æ¨¡å—           | è¯´æ˜                                                                                  |
| ------------ | ----------------------------------------------------------------------------------- |
| `backend/`   | FastAPI åç«¯æœåŠ¡ï¼ˆæ¨¡å‹æ‰“åˆ†ã€æ‰¹é‡é¢„æµ‹ã€é˜ˆå€¼æ ¡å‡†ã€è¶‹åŠ¿åˆ†æï¼‰                                                   |
| `frontend/`  | React + TypeScript å‰ç«¯æ§åˆ¶å°ï¼ˆåœ¨çº¿é¢„æµ‹ã€æ‰¹é‡è¯„ä¼°ã€PRæ›²çº¿ã€å¯è§†åŒ–ï¼‰                                        |
| `scorer.py`  | æ™ºèƒ½é™å™ªå¼•æ“ï¼šèåˆ ML æ¨¡å‹ + è§„åˆ™ç³»ç»Ÿ + æµé‡ä¸æ‹“æ‰‘æ„ŸçŸ¥                                                    |
| `api.py`     | FastAPI ä¸»æœåŠ¡ï¼šæä¾› `/predict`, `/batch_predict`, `/calibrate`, `/meta`, `/overview` ç­‰æ¥å£ |
| `static/`    | å­˜æ”¾æ ¡å‡†ç”Ÿæˆçš„ `pr_curve_api.png`ã€`pr_points_api.csv` ç­‰äº§ç‰©                                  |
| `rules.yaml` | å¯æ‰©å±•è§„åˆ™é…ç½®ï¼ˆå“åº”å…³é”®å­—ã€UAé»‘åå•ã€ä½å±é™æƒã€é‡å¤æŠ‘åˆ¶ç­‰ï¼‰                                                     |

---

## ğŸ§© ç³»ç»Ÿæ¶æ„

```mermaid
flowchart TD
A[å‰ç«¯ UI] -->|JSON è¯·æ±‚| B[FastAPI API å±‚]
B -->|/predict /batch /calibrate| C[Scorer è¯„åˆ†å¼•æ“]
C -->|è°ƒç”¨| D[è§„åˆ™å¼•æ“]
D -->|è°ƒæ•´| E[èåˆå™¨ Fuser]
E -->|å†™é˜ˆå€¼| F[threshold_fuse.txt]
E -->|äº§å‡º| G[static ç›®å½•: PR æ›²çº¿ / CSV]
B -->|å“åº”| A


subgraph "Data Sources"
H[å‘Šè­¦æ—¥å¿—é›†]
I[æµé‡ç‰¹å¾ FlowData]
J[æ‹“æ‰‘æ•°æ® TopoData]
end


H --> C
I --> C
J --> C
```

---

## âš™ï¸ å¿«é€Ÿéƒ¨ç½²

### ç¯å¢ƒè¦æ±‚

* Python â‰¥ 3.10
* Node.js â‰¥ 18.0
* æ¨èæ“ä½œç³»ç»Ÿï¼šLinux / macOS / Windows 10+

### å®‰è£…ä¾èµ–

```bash
# åç«¯ä¾èµ–
pip install -r requirements.txt

# å‰ç«¯ä¾èµ–
cd frontend
npm install
```

### å¯åŠ¨æœåŠ¡

```bash
# å¯åŠ¨ FastAPI åç«¯
python api.py
# é»˜è®¤ç«¯å£ http://127.0.0.1:8000

# å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨
cd frontend
npm run dev
# è®¿é—® http://localhost:5173
```

---

## ğŸš€ åŠŸèƒ½æ¨¡å—

| æ¨¡å—               | æè¿°                                             |
| ---------------- | ---------------------------------------------- |
| **å•æ¡é¢„æµ‹**         | é€šè¿‡ `/predict` å®æ—¶åˆ†æå•æ¡æ—¥å¿—ï¼Œè¾“å‡ºæ”»å‡»æ¦‚ç‡ã€è§„åˆ™å‘½ä¸­ä¸å…³é”®è¯è§£é‡Š       |
| **æ‰¹é‡é¢„æµ‹**         | `/batch_predict` æ”¯æŒ JSONL æ–‡ä»¶æ‰¹é‡è¯„ä¼°ï¼Œè¾“å‡ºæ±‡æ€»ç»Ÿè®¡        |
| **æ¨¡å‹æ ¡å‡†**         | `/calibrate` è‡ªåŠ¨è®¡ç®— PR æ›²çº¿å¹¶æ›´æ–°æœ€ä¼˜é˜ˆå€¼ï¼Œç”Ÿæˆ PNG ä¸ CSV ç»“æœ |
| **æ¨¡å‹çŠ¶æ€æŸ¥è¯¢**       | `/meta` è¿”å›èåˆå™¨åŠ è½½çŠ¶æ€ã€å½“å‰é˜ˆå€¼ã€æœ€è¿‘ä¸€æ¬¡æ ‡å®šå‚æ•°                |
| **Dashboard æ¦‚è§ˆ** | å±•ç¤ºè¿‡å»24å°æ—¶è¶‹åŠ¿ã€Top URI/UAã€æ”»å‡»ç‡æ³¢åŠ¨ç­‰å›¾è¡¨                 |

---

## ğŸ“ˆ ç¤ºä¾‹å¯è§†åŒ–

### æ¨¡å‹ç»“æ„ä¸é€»è¾‘æµç¨‹

![](./static/architecture.png)

### å‰ç«¯ç•Œé¢é¢„è§ˆ

![](./static/dashboard_preview.png)

### PR æ›²çº¿æ ·ä¾‹

![](./static/pr_curve_api.png)

---

## ğŸ§  æ ¸å¿ƒåŸç†

AegisSense é‡‡ç”¨â€œä¸‰å±‚èåˆæ¨¡å‹â€å®ç°æ—¥å¿—åˆ¤å®šï¼š

1. **TF-IDF + LR æ¨¡å‹å±‚**ï¼šæå–æ–‡æœ¬ç‰¹å¾ï¼Œè¾“å‡ºåŸºç¡€æ”»å‡»æ¦‚ç‡ã€‚
2. **è§„åˆ™ä¿®æ­£å±‚**ï¼šæ ¹æ®è§„åˆ™åº“åŠ¨æ€è°ƒæ•´ç½®ä¿¡åº¦ï¼ˆå¦‚ä½å±é™æƒã€æ¢æµ‹UAã€é‡å¤æ—¥å¿—æŠ‘åˆ¶ï¼‰ã€‚
3. **èåˆå™¨å±‚ (Fuser)**ï¼šæ•´åˆå¤šç»´ç‰¹å¾ï¼ˆè¯­ä¹‰ã€è§„åˆ™ã€æµé‡ã€æ‹“æ‰‘ï¼‰ï¼Œè¿›è¡Œæœ€ç»ˆæ‰“åˆ†ã€‚

---

## ğŸ“Š Dashboard æ€»è§ˆåŠŸèƒ½

| åŒºåŸŸ                  | åŠŸèƒ½              |
| ------------------- | --------------- |
| ğŸ“… 24å°æ—¶è¶‹åŠ¿å›¾          | å±•ç¤ºæ”»å‡»ä¸è¯¯æŠ¥æ¯”ä¾‹å˜åŒ–è¶‹åŠ¿   |
| ğŸ§­ Top URI / Top UA | æ‰‡å½¢å›¾å±•ç¤ºæ”»å‡»æºçƒ­ç‚¹      |
| ğŸŒ å›½å®¶/åœ°åŒºåˆ†å¸ƒ          | æŸ±çŠ¶å›¾å±•ç¤ºæ¥æºåœ°ç»Ÿè®¡      |
| âš ï¸ å¼‚å¸¸å³°å€¼             | è‡ªåŠ¨æ ‡è¯†æµé‡/æ”»å‡»æš´å¢æ—¶æ®µ   |
| ğŸ§© æ¨¡å‹çŠ¶æ€å¡ç‰‡           | å½“å‰é˜ˆå€¼ã€èåˆå™¨ã€è§„åˆ™æ›´æ–°çŠ¶æ€ |

---

## ğŸ§  å¯è§£é‡Šæ€§

æ¨¡å‹é¢„æµ‹ç»“æœåŒ…å«ï¼š

* `top_terms`: å‰10ä¸ªå…³é”®æƒé‡ç‰¹å¾è¯
* `rules`: å‘½ä¸­è§„åˆ™æ ‡ç­¾
* `score_raw` ä¸ `score_final`: è°ƒæ•´å‰ååˆ†æ•°

å¸®åŠ©å®‰å…¨åˆ†æäººå‘˜å¿«é€Ÿç†è§£æ¨¡å‹åˆ¤å®šä¾æ®ã€‚

---

## ğŸ§ª æ•°æ®é›†è¯´æ˜

é¡¹ç›®ä½¿ç”¨å…¬å¼€æ•°æ®é›†ï¼š

> [`tiangler/cybersecurity_alarm_analysis`](https://huggingface.co/datasets/tiangler/cybersecurity_alarm_analysis)

åŒ…å«å¤šç±»å‹å®‰å…¨å‘Šè­¦æ ·æœ¬ï¼Œè¦†ç›–å¸¸è§ Web æ”»å‡»æ¨¡å¼ä¸é˜²æŠ¤æ—¥å¿—ï¼Œç”¨äºæ¨¡å‹è®­ç»ƒå’Œé˜ˆå€¼æ ¡å‡†ã€‚

---

## ğŸ”§ è·¯çº¿å›¾

| é˜¶æ®µ      | åŠŸèƒ½                  | çŠ¶æ€ |
| ------- | ------------------- | -- |
| Phase 1 | åŸºç¡€é¢„æµ‹ / æ‰¹é‡è¯„ä¼° / é˜ˆå€¼æ ¡å‡†  | âœ…  |
| Phase 2 | Dashboard ç»Ÿè®¡ä¸å›¾è¡¨     | âœ…  |
| Phase 3 | æ”»å‡»èšç±»ï¼ˆBERT / KMeansï¼‰ | ğŸš§ |
| Phase 4 | å®æ—¶æ—¥å¿—æµ (Kafka)       | ğŸ”œ |
| Phase 5 | åŒºå—é“¾å­˜è¯        | ğŸ”œ |

---

## ğŸ¤ å¼€æºåè®®

MIT License Â© 2025 **A1LinLin1**

> â€œIn the ocean of alerts, AegisSense guards the signal.â€
> åœ¨å‘Šè­¦çš„æµ·æ´‹ä¸­ï¼ŒAegisSense å®ˆæŠ¤çœŸæ­£çš„ä¿¡å·ã€‚
